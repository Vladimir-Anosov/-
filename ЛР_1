#include <iostream>
#include <cmath>
#include <stdexcept>
#include <string>


class CustomException : public std::exception
{
private:
    std::string message;  // Сообщение об ошибке
    double value;         // Значение, вызвавшее ошибку
    int errorCode;        // Код ошибки
public:
    CustomException(const std::string& msg, double val, int code)
        : message(msg), value(val), errorCode(code) {}

    const char* what() const noexcept override
    {
        return message.c_str();
    }

    double getValue() const
    {
        return value;
    }

    int getErrorCode() const
    {
        return errorCode;
    }
};

// Функция для вычисления Z1
void calculate_z1(double x, double& z1)
{
    try
    {
        double sqrt_term = sqrt(x * x - 9);
        double denominator = x * x - 2 * x - 3 + (x - 1) * sqrt_term;
        if (denominator == 0)
        {
            throw CustomException("Деление на ноль в Z1", x, 101);
        }
        z1 = (x * x + 2 * x - 3 + (x + 1) * sqrt_term) / denominator;
    }
    catch (const std::domain_error&)
    {
        throw CustomException("Неверная операция в Z1", x, 102);
    }
}

// Функция для вычисления Z2
void calculate_z2(double x, double& z2)
{
    try
    {
        if (x - 3 == 0)
        {
            throw CustomException("Деление на ноль в Z2", x, 103);
        }
        z2 = sqrt((x + 3) / (x - 3));
    }
    catch (const std::domain_error&)
    {
        throw CustomException("Неверная операция в Z2", x, 104);
    }
}

int main()
{
    setlocale(LC_ALL, "Russian");

    double x = 5.0;  // Пример значения; можно изменить для проверки других случаев
    double z1 = 0.0, z2 = 0.0;

    try
    {
        calculate_z1(x, z1);
        calculate_z2(x, z2);

        std::cout << "Z1: " << z1 << std::endl;
        std::cout << "Z2: " << z2 << std::endl;

        if (std::fabs(z1 - z2) < 1e-9)
        {
            std::cout << "Z1 и Z2 приблизительно равны." << std::endl;
        }
        else {
            std::cout << "Z1 и Z2 не приблизительно равны." << std::endl;
        }
    }
    catch (const CustomException& e)
    {
        std::cerr << e.what() << " (Значение: " << e.getValue() << ", Код ошибки: " << e.getErrorCode() << ")" << std::endl;
    }

    return 0;
}
